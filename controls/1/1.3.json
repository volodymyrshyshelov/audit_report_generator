[
  {
    "id": "1.3.1",
    "level": "L1",
    "title": "Ensure the 'Password expiration policy' is set to 'Set passwords to never expire (recommended)'",
    "type": "Automated",
    "profile_applicability": "E3 Level 1",
    "description": "Set passwords to never expire in Microsoft 365. Microsoft no longer recommends that organizations force periodic password changes. Forcing frequent password changes can result in users selecting predictable passwords, using similar passwords in a sequence, or writing down passwords—thus defeating the purpose of increased password security.",
    "rationale": "Periodic password expiration policies are no longer recommended as a default policy. Modern authentication recommendations and best practices suggest eliminating password expiration policies and using multi-factor authentication, detection of anomalous logins, and other protections to keep identities secure.",
    "impact": "Users will not be required to change their passwords periodically. Other security measures, such as MFA, are required to reduce the risk of compromised accounts.",
    "output": "<PowerShell output verifying password never expires>",
    "remediation": "To set the password policy so that passwords never expire:\n\n1. Connect to Microsoft 365 PowerShell.\n2. Run the following command:\nSet-MsolPasswordPolicy -DomainName <your domain> -ValidityPeriod 2147483647",
    "audit_ui": "1. Go to https://admin.microsoft.com\n2. Settings > Org settings > Security & privacy\n3. Review the Password expiration policy section",
    "audit_powershell": "Connect to M365 PowerShell and run:\nGet-MsolPasswordPolicy -DomainName <your domain>",
    "references": [
      "https://learn.microsoft.com/en-us/microsoft-365/admin/misc/password-policy-recommendations",
      "https://learn.microsoft.com/en-us/security/compass/identity-access",
      "https://learn.microsoft.com/en-us/entra/fundamentals/security-best-practices"
    ]
  },
  {
    "id": "1.3.2",
    "level": "L1",
    "title": "Ensure 'Idle session timeout' is set to '3 hours (or less)' for unmanaged devices",
    "type": "Manual",
    "profile_applicability": "E3 Level 1",
    "description": "Set idle session timeout to sign out users automatically after a period of inactivity, especially on unmanaged devices. This feature is useful to protect sensitive data in environments where users may leave their workstations unattended.",
    "rationale": "Enabling idle session timeout reduces the risk of unauthorized access to data from an unattended session, especially on unmanaged devices.",
    "impact": "Users may be signed out unexpectedly during periods of inactivity, requiring them to re-authenticate.",
    "output": "<Review session policy in Entra Conditional Access>",
    "remediation": "Use Conditional Access to configure session policies:\n\n1. Go to https://entra.microsoft.com\n2. Identity > Conditional Access > Policies\n3. Create or edit a policy with Session controls > Sign-in frequency and Idle session timeout",
    "audit_ui": "1. Navigate to Microsoft Entra admin center\n2. Identity > Conditional Access > Policies\n3. Review any policy applying to unmanaged devices\n4. Check Session controls are configured with Idle timeout <= 3 hours",
    "references": [
      "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-session-lifetime",
      "https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-session-lifetime"
    ]
  },
  {
    "id": "1.3.3",
    "level": "L2",
    "title": "Ensure 'External sharing' of calendars is not available",
    "type": "Automated",
    "profile_applicability": "E3 Level 2",
    "description": "Restricting calendar sharing with people outside of your organization prevents accidental data leakage via calendar invites, notes, or events.",
    "rationale": "Users may inadvertently expose sensitive data by sharing calendars with external users.",
    "impact": "External parties will not be able to view internal calendars. This may impact scheduling with outside vendors or clients.",
    "output": "<PowerShell output showing external sharing setting>",
    "remediation": "1. Connect to Exchange Online PowerShell\n2. Run:\nSet-SharingPolicy -Identity 'Default Sharing Policy' -Domains $null -Enabled $false",
    "audit_ui": "1. Go to Exchange Admin Center (https://admin.exchange.microsoft.com)\n2. Organization > Sharing\n3. Review the Sharing Policy and verify external domains are not included",
    "audit_powershell": "Connect to Exchange Online:\nGet-SharingPolicy | fl Identity, Domains, Enabled",
    "references": [
      "https://learn.microsoft.com/en-us/exchange/sharing/sharing-policies/sharing-policies"
    ]
  },
  {
    "id": "1.3.4",
    "level": "L1",
    "title": "Ensure 'User owned apps and services' is restricted",
    "type": "Manual",
    "profile_applicability": "E3 Level 1",
    "description": "Control whether users can install and manage their own apps and services. Disabling this setting helps ensure that only approved applications are used within the environment.",
    "rationale": "Limiting the ability to install unmanaged applications helps reduce the risk of shadow IT and potential data leakage.",
    "impact": "Users may not be able to install certain third-party tools or integrations.",
    "output": "<Review setting in Microsoft 365 admin center>",
    "remediation": "1. Navigate to https://admin.microsoft.com\n2. Go to Settings > Org settings > User owned apps and services\n3. Disable the options allowing users to add new apps",
    "audit_ui": "1. Go to Microsoft 365 admin center\n2. Org settings > Services > User owned apps and services\n3. Review the toggles are disabled",
    "references": [
      "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/manage-user-consent?view=o365-worldwide"
    ]
  },
  {
    "id": "1.3.5",
    "level": "L1",
    "title": "Ensure internal phishing protection for Forms is enabled",
    "type": "Manual",
    "profile_applicability": "E3 Level 1",
    "description": "Microsoft Forms includes phishing protection that helps prevent internal users from using Forms maliciously (e.g., to collect credentials). This setting should be enabled to automatically block suspicious content.",
    "rationale": "Preventing internal phishing protects organizational integrity and data.",
    "impact": "Some legitimate forms may be blocked until reviewed by administrators.",
    "output": "<Check Microsoft Forms settings via UI>",
    "remediation": "1. Go to https://admin.microsoft.com\n2. Settings > Org Settings > Microsoft Forms\n3. Enable 'Block forms created for phishing attempts by internal users'",
    "audit_ui": "1. Microsoft 365 admin center > Org Settings > Microsoft Forms\n2. Check that phishing protection is enabled",
    "references": [
      "https://learn.microsoft.com/en-us/microsoft-forms/review-unblock-forms-users-detected-blocked-potential-phishing"
    ]
  },
  {
    "id": "1.3.6",
    "level": "L2",
    "title": "Ensure the customer lockbox feature is enabled",
    "type": "Automated",
    "profile_applicability": "E3 Level 2",
    "description": "Customer Lockbox requires explicit approval before Microsoft engineers can access customer content during support operations. This feature ensures control over data access during troubleshooting.",
    "rationale": "Provides transparency and auditability regarding Microsoft access to your data.",
    "impact": "Some support requests may take longer to resolve due to approval requirements.",
    "output": "<PowerShell output showing lockbox status>",
    "remediation": "1. Go to https://compliance.microsoft.com\n2. Settings > Customer Lockbox\n3. Enable the feature",
    "audit_ui": "1. Microsoft 365 Compliance center > Solutions > Customer Lockbox\n2. Check status is Enabled",
    "references": [
      "https://learn.microsoft.com/en-us/microsoft-365/compliance/customer-lockbox-requests?view=o365-worldwide"
    ]
  },
  {
    "id": "1.3.7",
    "level": "L2",
    "title": "Ensure 'third-party storage services' are restricted in 'Microsoft 365 on the web'",
    "type": "Manual",
    "profile_applicability": "E3 Level 2",
    "description": "Restricting third-party storage integration in M365 web applications ensures documents are stored within Microsoft-approved environments (e.g., OneDrive, SharePoint).",
    "rationale": "Minimizes risk of data exfiltration by preventing connections to untrusted storage providers.",
    "impact": "Users won’t be able to open or save files from/to Dropbox, Box, or similar services in M365 web apps.",
    "output": "<Check setting via UI>",
    "remediation": "1. Go to https://admin.microsoft.com\n2. Org settings > Office on the web\n3. Disable 'Let people in your organization use third-party storage services'",
    "audit_ui": "1. Microsoft 365 Admin Center > Org Settings > Office on the web\n2. Ensure third-party storage services is disabled",
    "references": [
      "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/connected-services"
    ]
  },
  {
    "id": "1.3.8",
    "level": "L2",
    "title": "Ensure that Sways cannot be shared with people outside of your organization",
    "type": "Manual",
    "profile_applicability": "E3 Level 2",
    "description": "Prevent users from sharing Microsoft Sways externally to avoid unintended exposure of content.",
    "rationale": "Sway presentations may contain confidential information. Disabling external sharing helps prevent accidental leaks.",
    "impact": "External partners cannot view Sways unless access is re-enabled.",
    "output": "<UI review of Sway sharing settings>",
    "remediation": "1. Go to https://admin.microsoft.com\n2. Org Settings > Sway\n3. Uncheck 'Let people in your organization share their Sways with external people'",
    "audit_ui": "1. Microsoft 365 Admin Center > Org Settings > Sway\n2. Ensure external sharing is disabled",
    "references": [
      "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/manage-sway"
    ]
  }
]
